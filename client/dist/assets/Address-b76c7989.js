import{r as a,_ as V,U as J,n as D,u as M,b as n,j as N,L as H,c as $,o as q,i as B}from"./index-d73aedfc.js";import{a as G}from"./add-31624fdf.js";import{a as K}from"./axios-707ed124.js";let I;const Q=new Uint8Array(16);function W(){if(!I&&(I=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!I))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(Q)}const t=[];for(let e=0;e<256;++e)t.push((e+256).toString(16).slice(1));function X(e,s=0){return(t[e[s+0]]+t[e[s+1]]+t[e[s+2]]+t[e[s+3]]+"-"+t[e[s+4]]+t[e[s+5]]+"-"+t[e[s+6]]+t[e[s+7]]+"-"+t[e[s+8]]+t[e[s+9]]+"-"+t[e[s+10]]+t[e[s+11]]+t[e[s+12]]+t[e[s+13]]+t[e[s+14]]+t[e[s+15]]).toLowerCase()}const Y=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),E={randomUUID:Y};function Z(e,s,o){if(E.randomUUID&&!s&&!e)return E.randomUUID();e=e||{};const d=e.random||(e.rng||W)();if(d[6]=d[6]&15|64,d[8]=d[8]&63|128,s){o=o||0;for(let m=0;m<16;++m)s[o+m]=d[m];return s}return X(d)}const T=a.lazy(()=>V(()=>import("./DisplayAddress-3a29e11f.js"),["assets/DisplayAddress-3a29e11f.js","assets/index-d73aedfc.js","assets/index-af484219.css","assets/userStyles-33da4f03.css"])),ee=a.lazy(()=>V(()=>import("./AddressForm-f9a3ab37.js"),["assets/AddressForm-f9a3ab37.js","assets/index-d73aedfc.js","assets/index-af484219.css"]));function ae(){var U,_,P,k;const e=a.useRef(null),s=a.useRef(null),o=sessionStorage.getItem("sourcePath"),{currentUser:d,userDispatch:m}=a.useContext(J),[u,f]=a.useState({id:Z(),name:"",phone:"",pincode:"",locality:"",address:"",town:"",state:"",landmark:"",alternatePhone:"",addressType:""}),[A,S]=a.useState(!1),[L,R]=a.useState(!1),[C,p]=a.useState("");a.useEffect(()=>{document.title="My Addresses",sessionStorage.getItem(D)==="Addresses"&&S(!0),o&&R(!0),sessionStorage.removeItem(D)},[]);const x=M();a.useEffect(()=>{A?s==null||s.current.scrollIntoView():e==null||e.current.scrollIntoView({behavior:"smooth"}),!A&&L&&o&&(x(o),sessionStorage.removeItem("sourcePath"))},[A]);function j(l){f(r=>({...r,[l.target.name]:l.target.value}))}async function O(l){var r,h,g,v,y;if(l.preventDefault(),((r=u.phone)==null?void 0:r.length)!==10){p("Invalid mobile number! please enter a valid mobile number");return}else if(((h=u.pincode)==null?void 0:h.length)!==6){p("Invalid  pincode! please enter a valid  pincode");return}else if(((g=u.alternatePhone)==null?void 0:g.length)!==10&&((v=u.alternatePhone)==null?void 0:v.length)!==0){p("Invalid  alternate phone number! please enter a valid  alternate phone number");return}else if(u.state===""){p("Please select state");return}else p(" ");try{const i=await K.post(`${$}/auth/updateUser/addAddress`,{newAddress:u,token:localStorage.getItem("accessToken")});localStorage.setItem("accessToken",i.data);const c=q(i.data);c&&m({type:B,payload:c==null?void 0:c.resData})}catch(i){p((y=i==null?void 0:i.response)==null?void 0:y.data)}o&&(o&&x(o),sessionStorage.removeItem("sourcePath"))}const z=(_=(U=d==null?void 0:d.address)==null?void 0:U.home)==null?void 0:_.map(l=>{const{id:r,addressType:h,name:g,phone:v,address:y,locality:i,town:c,state:w,pincode:b}=JSON.parse(l);return n(a.Suspense,{fallback:n("div",{children:"loading..."}),children:n(T,{data:{id:r,addressType:h,name:g,phone:v,address:y,locality:i,town:c,state:w,pincode:b}},r)},r)}),F=(k=(P=d==null?void 0:d.address)==null?void 0:P.work)==null?void 0:k.map(l=>{const{id:r,addressType:h,name:g,phone:v,address:y,locality:i,town:c,state:w,pincode:b}=JSON.parse(l);return n(a.Suspense,{fallback:n("div",{children:"loading..."}),children:n(T,{data:{id:r,addressType:h,name:g,phone:v,address:y,locality:i,town:c,state:w,pincode:b}},r)},r)});return N("div",{className:"address",ref:e,children:[n("h2",{children:"Manage Addresses"}),N("div",{className:"addresses",children:[n("div",{className:"homeAdresses",children:z}),n("div",{className:"workAddresses",children:F}),A?n("div",{className:"newAddressForm",ref:s,children:n(a.Suspense,{fallback:n(H,{}),children:n(ee,{newAddress:u,handleChange:j,handleSubmit:O,error:C,setIsAddingNewAddress:S,srcPath:o})})}):N("div",{className:"addNewAddress",onClick:()=>{S(!0)},children:[n("img",{src:G,alt:"symbol for add"}),n("span",{children:"Add a new address"})]})]})]})}export{ae as default};
